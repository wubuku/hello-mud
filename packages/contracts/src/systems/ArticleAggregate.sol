// SPDX-License-Identifier: MIT
pragma solidity >=0.8.24;

/* Autogenerated file. Do not edit manually. */

import { System } from "@latticexyz/world/src/System.sol";
import { Article, ArticleData, ArticleIdGenerator } from "../codegen/index.sol";
import { TagAdded, ArticleCreated, ArticleUpdated, ArticleDeleted, CommentAdded, CommentUpdated, CommentRemoved } from "./ArticleEvents.sol";
import { ArticleAddTagLogic } from "./ArticleAddTagLogic.sol";
import { ArticleCreateLogic } from "./ArticleCreateLogic.sol";
import { ArticleUpdateLogic } from "./ArticleUpdateLogic.sol";
import { ArticleDeleteLogic } from "./ArticleDeleteLogic.sol";
import { ArticleAddCommentLogic } from "./ArticleAddCommentLogic.sol";
import { ArticleUpdateCommentLogic } from "./ArticleUpdateCommentLogic.sol";
import { ArticleRemoveCommentLogic } from "./ArticleRemoveCommentLogic.sol";

abstract contract ArticleAggregate is System {
  error ArticleAlreadyExists(uint64 id);
  error ArticleDoesNotExist(uint64 id);

  event TagAddedEvent(uint64 indexed id, string tag);

  event ArticleCreatedEvent(uint64 indexed id, address author, string title, string body);

  event ArticleUpdatedEvent(uint64 indexed id, address author, string title, string body);

  event ArticleDeletedEvent(uint64 indexed id);

  event CommentAddedEvent(uint64 indexed id, uint64 commentSeqId, string commenter, string body);

  event CommentUpdatedEvent(uint64 indexed id, uint64 commentSeqId, string commenter, string body);

  event CommentRemovedEvent(uint64 indexed id, uint64 commentSeqId);

  function articleAddTag(uint64 id, string memory tag) public virtual {
    ArticleData memory articleData = Article.get(id);
    if (articleData.author == address(0) && bytes(articleData.title).length == 0 && bytes(articleData.body).length == 0) {
      revert ArticleDoesNotExist(id);
    }
    TagAdded memory tagAdded = ArticleAddTagLogic.verify(id, tag, articleData);
    tagAdded.id = id;
    emit TagAddedEvent(tagAdded.id, tagAdded.tag);
    ArticleData memory updatedArticleData = ArticleAddTagLogic.mutate(tagAdded, articleData);
    Article.set(id, updatedArticleData);
  }

  function articleCreate(address author, string memory title, string memory body) public virtual {
    uint64 id = ArticleIdGenerator.get() + 1;
    ArticleIdGenerator.set(id);
    ArticleData memory articleData = Article.get(id);
    if (!(articleData.author == address(0) && bytes(articleData.title).length == 0 && bytes(articleData.body).length == 0)) {
      revert ArticleAlreadyExists(id);
    }
    ArticleCreated memory articleCreated = ArticleCreateLogic.verify(id, author, title, body);
    articleCreated.id = id;
    emit ArticleCreatedEvent(articleCreated.id, articleCreated.author, articleCreated.title, articleCreated.body);
    ArticleData memory newArticleData = ArticleCreateLogic.mutate(articleCreated);
    Article.set(id, newArticleData);
  }

  function articleUpdate(uint64 id, address author, string memory title, string memory body) public virtual {
    ArticleData memory articleData = Article.get(id);
    if (articleData.author == address(0) && bytes(articleData.title).length == 0 && bytes(articleData.body).length == 0) {
      revert ArticleDoesNotExist(id);
    }
    ArticleUpdated memory articleUpdated = ArticleUpdateLogic.verify(id, author, title, body, articleData);
    articleUpdated.id = id;
    emit ArticleUpdatedEvent(articleUpdated.id, articleUpdated.author, articleUpdated.title, articleUpdated.body);
    ArticleData memory updatedArticleData = ArticleUpdateLogic.mutate(articleUpdated, articleData);
    Article.set(id, updatedArticleData);
  }

  function articleDelete(uint64 id) public virtual {
    ArticleData memory articleData = Article.get(id);
    if (articleData.author == address(0) && bytes(articleData.title).length == 0 && bytes(articleData.body).length == 0) {
      revert ArticleDoesNotExist(id);
    }
    ArticleDeleted memory articleDeleted = ArticleDeleteLogic.verify(id, articleData);
    articleDeleted.id = id;
    emit ArticleDeletedEvent(articleDeleted.id);
    ArticleData memory updatedArticleData = ArticleDeleteLogic.mutate(articleDeleted, articleData);
    Article.set(id, updatedArticleData);
  }

  function articleAddComment(uint64 id, string memory commenter, string memory body) public virtual {
    ArticleData memory articleData = Article.get(id);
    if (articleData.author == address(0) && bytes(articleData.title).length == 0 && bytes(articleData.body).length == 0) {
      revert ArticleDoesNotExist(id);
    }
    CommentAdded memory commentAdded = ArticleAddCommentLogic.verify(id, commenter, body, articleData);
    commentAdded.id = id;
    emit CommentAddedEvent(commentAdded.id, commentAdded.commentSeqId, commentAdded.commenter, commentAdded.body);
    ArticleData memory updatedArticleData = ArticleAddCommentLogic.mutate(commentAdded, articleData);
    Article.set(id, updatedArticleData);
  }

  function articleUpdateComment(uint64 id, uint64 commentSeqId, string memory commenter, string memory body) public virtual {
    ArticleData memory articleData = Article.get(id);
    if (articleData.author == address(0) && bytes(articleData.title).length == 0 && bytes(articleData.body).length == 0) {
      revert ArticleDoesNotExist(id);
    }
    CommentUpdated memory commentUpdated = ArticleUpdateCommentLogic.verify(id, commentSeqId, commenter, body, articleData);
    commentUpdated.id = id;
    emit CommentUpdatedEvent(commentUpdated.id, commentUpdated.commentSeqId, commentUpdated.commenter, commentUpdated.body);
    ArticleData memory updatedArticleData = ArticleUpdateCommentLogic.mutate(commentUpdated, articleData);
    Article.set(id, updatedArticleData);
  }

  function articleRemoveComment(uint64 id, uint64 commentSeqId) public virtual {
    ArticleData memory articleData = Article.get(id);
    if (articleData.author == address(0) && bytes(articleData.title).length == 0 && bytes(articleData.body).length == 0) {
      revert ArticleDoesNotExist(id);
    }
    CommentRemoved memory commentRemoved = ArticleRemoveCommentLogic.verify(id, commentSeqId, articleData);
    commentRemoved.id = id;
    emit CommentRemovedEvent(commentRemoved.id, commentRemoved.commentSeqId);
    ArticleData memory updatedArticleData = ArticleRemoveCommentLogic.mutate(commentRemoved, articleData);
    Article.set(id, updatedArticleData);
  }

}
